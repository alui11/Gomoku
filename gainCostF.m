function gainCostSquares = gainCostF(board)
% gainCostSquares = threatSpace(board)
% Input: a gomoku board state
% Output: a structure array where each index corresponds to
% one gain square and its assocaited cost squares
% gainCostSquares(X).gain = [x, y]
% gainCostSquares(X).cost = [a, b; c, d; e, f]

%% key sequences:

% Possible closed 4s
% 011102
% 010112
% 011012
% 211100
% 210110
% 211010
closedFours = {[0 1 1 1 0 2], [0 1 0 1 1 2], [0 1 1 0 1 2],...
    [2 1 1 1 0 0], [2 1 0 1 1 0], [2 1 1 0 1 0]};

% maybe: (need 1 zero)
% 011121
% 011120
% 011122
fourAddZero = {[0 1 1 1 2 1], [0 1 1 1 2 0], [0 1 1 1 2 2]};

% Possible open 3s
% 010100
% 011000
% 010010
openThrees = {[0 1 0 1 0 0], [0 1 1 0 0 0], [0 1 0 0 1 0]};

% maybe: (need 1 zero)
% 010102
% 011002
% 011001
% 010101
% 010102
threeAddZero = {[0 1 0 1 0 2], [0 1 1 0 0 2], [0 1 1 0 0 1],...
    [0 1 0 1 0 1]};

% maybe: (need 2 zeros)
% 011022
% 011012
% 011021
% 011020
threeAdd2Zeros = {[0 1 1 0 2 2], [0 1 1 0 1 2], [0 1 1 0 2 1],...
    [0 1 1 0 2 0]};

allSequences = [closedFours, openThrees, fourAddZero,...
    threeAddZero, threeAdd2Zeros];

%% Search for initial checks
counter = 0;
for iRow = 1:15
    for iCol = 1:15
        if board(iRow, iCol) == 1
            counter = counter + 1;
            check1(counter).row = iRow;
            check1(counter).column = iCol;
            check2(counter).row = iRow;
            check2(counter).column = iCol;
            check3(counter).row = iRow;
            check3(counter).column = iCol;
            check4(counter).row = iRow;
            check4(counter).column = iCol;
            %forward
            if iCol <= 11 && iCol >= 2
                check1(counter).vector = board(iRow, iCol-1:iCol+4);
            elseif iCol == 12
                check1(counter).vector = [board(iRow, iCol-1:iCol+3), 2];
            elseif iCol == 13
                check1(counter).vector = [board(iRow, iCol-1:iCol+2), 2, 2];
            elseif iCol == 1
                check1(counter).vector = [2, board(iRow, iCol:iCol+4)];
            else
                check1(counter).vector = 0;
            end
            %down
            if iRow <= 11 && iRow >= 2
                check2(counter).vector = board(iRow-1:iRow+4, iCol)';
            elseif iRow == 12
                check2(counter).vector = [board(iRow-1:iRow+3, iCol); 2]';
            elseif iRow == 13
                check2(counter).vector = [board(iRow-1:iRow+2, iCol); 2; 2]';
            elseif iRow == 1
                check2(counter).vector = [2; board(iRow:iRow+4, iCol)]';
            else
                check2(counter).vector = 0;
            end
            %diagonal forward
            if iRow <= 11 && iRow >= 2 && iCol <= 11 && iCol >= 2
                check3(counter).vector = [board(iRow-1,iCol-1), board(iRow,iCol),...
                    board(iRow+1,iCol+1), board(iRow+2,iCol+2),...
                    board(iRow+3,iCol+3), board(iRow+4,iCol+4)];
            elseif iRow == 12 && iCol <= 12 && iCol >= 2
                check3(counter).vector = [board(iRow-1,iCol-1), board(iRow,iCol),...
                    board(iRow+1,iCol+1), board(iRow+2,iCol+2),...
                    board(iRow+3,iCol+3), 2];
            elseif iRow == 13 && iCol <= 13 && iCol >= 2
                check3(counter).vector = [board(iRow-1,iCol-1), board(iRow,iCol),...
                    board(iRow+1,iCol+1), board(iRow+2,iCol+2),...
                    2, 2];
            elseif iRow == 1 && iCol <= 11
                check3(counter).vector = [2, board(iRow,iCol),...
                    board(iRow+1,iCol+1), board(iRow+2,iCol+2),...
                    board(iRow+3,iCol+3), board(iRow+4,iCol+4)];
            elseif iCol == 12 && iRow <= 12 && iRow >= 2
                check3(counter).vector = [board(iRow-1,iCol-1), board(iRow,iCol),...
                    board(iRow+1,iCol+1), board(iRow+2,iCol+2),...
                    board(iRow+3,iCol+3), 2];
            elseif iCol == 13 && iRow <= 13 && iRow >= 2
                check3(counter).vector = [board(iRow-1,iCol-1), board(iRow,iCol),...
                    board(iRow+1,iCol+1), board(iRow+2,iCol+2),...
                    2, 2];
            elseif iCol == 1 && iRow <= 11
                check3(counter).vector = [2, board(iRow,iCol),...
                    board(iRow+1,iCol+1), board(iRow+2,iCol+2),...
                    board(iRow+3,iCol+3), board(iRow+4,iCol+4)];
            else
                check3(counter).vector = 0;
            end
            %diagonal backward
            if iRow <= 11 && iRow >= 2 && iCol <= 14 && iCol >= 5
                check4(counter).vector = [board(iRow-1,iCol+1), board(iRow,iCol),...
                    board(iRow+1,iCol-1), board(iRow+2,iCol-2),...
                    board(iRow+3,iCol-3), board(iRow+4,iCol-4)];
            elseif iRow == 12 && iCol <= 14 && iCol >= 4
                check4(counter).vector = [board(iRow-1,iCol+1), board(iRow,iCol),...
                    board(iRow+1,iCol-1), board(iRow+2,iCol-2),...
                    board(iRow+3,iCol-3), 2];
            elseif iRow == 13 && iCol <= 14 && iCol >= 3
                check4(counter).vector = [board(iRow-1,iCol+1), board(iRow,iCol),...
                    board(iRow+1,iCol-1), board(iRow+2,iCol-2),...
                    2, 2];
            elseif iRow == 1 && iCol >= 5
                check4(counter).vector = [2, board(iRow,iCol),...
                    board(iRow+1,iCol-1), board(iRow+2,iCol-2),...
                    board(iRow+3,iCol-3), board(iRow+4,iCol-4)];
            elseif iCol == 15 && iRow <= 11
                check4(counter).vector = [2, board(iRow,iCol),...
                    board(iRow+1,iCol-1), board(iRow+2,iCol-2),...
                    board(iRow+3,iCol-3), board(iRow+4,iCol-4)];
            elseif iCol == 4 && iRow >= 2 && iRow <= 12
                check4(counter).vector = [board(iRow-1,iCol+1), board(iRow,iCol),...
                    board(iRow+1,iCol-1), board(iRow+2,iCol-2),...
                    board(iRow+3,iCol-3), 2];
            elseif iCol == 3 && iRow >= 2 && iRow <= 13
                check4(counter).vector = [board(iRow-1,iCol+1), board(iRow,iCol),...
                    board(iRow+1,iCol-1), board(iRow+2,iCol-2),...
                    2, 2];
            else
                check4(counter).vector = 0;
            end
        end
    end
end

%% Any Matches?

counter2 = 0;

isMatch = false;
for istep = 1:counter
    for isequence = 1:length(allSequences)
        if isequal(check1(istep).vector, allSequences{isequence})
            isMatch = true;
            counter2 = counter2 + 1;
            matches(counter2).type = 1;
            matches(counter2).check = istep;
            matches(counter2).sequence = isequence;
        end
        if isequal(check2(istep).vector, allSequences{isequence})
            counter2 = counter2 + 1;
            isMatch = true;
            matches(counter2).type = 2;
            matches(counter2).check = istep;
            matches(counter2).sequence = isequence;
        end
        if isequal(check3(istep).vector, allSequences{isequence})
            counter2 = counter2 + 1;
            isMatch = true;
            matches(counter2).type = 3;
            matches(counter2).check = istep;
            matches(counter2).sequence = isequence;
        end
        if isequal(check4(istep).vector, allSequences{isequence})
            counter2 = counter2 + 1;
            isMatch = true;
            matches(counter2).type = 4;
            matches(counter2).check = istep;
            matches(counter2).sequence = isequence;
        end
    end
end

%% If matches, get rid of false maybes

if isMatch
    for imatch = 1:length(matches)
        if matches(imatch).sequence > 9 && matches(imatch).sequence < 17
            switch matches(imatch).type
                case 1
                    if check1(matches(imatch).check).column >= 3
                        if board(check1(matches(imatch).check).row,...
                                check1(matches(imatch).check).column-2) ~= 0
                            matches(imatch).type = 0;
                        end
                    else
                        matches(imatch).type = 0;
                    end
                case 2
                    if check2(matches(imatch).check).row >= 3
                        if board(check2(matches(imatch).check).row-2,...
                                check2(matches(imatch).check).column) ~= 0
                            matches(imatch).type = 0;
                        end
                    else
                        matches(imatch).type = 0;
                    end
                case 3
                    if check3(matches(imatch).check).row >= 3 &&...
                            check3(matches(imatch).check).column >= 3
                        if board(check3(matches(imatch).check).row-2,...
                                check3(matches(imatch).check).column-2) ~= 0
                            matches(imatch).type = 0;
                        end
                    else
                        matches(imatch).type = 0;
                    end
                case 4
                    if check4(matches(imatch).check).row >= 3 &&...
                            check4(matches(imatch).check).column <= 13
                        if board(check4(matches(imatch).check).row-2,...
                                check4(matches(imatch).check).column+2) ~= 0
                            matches(imatch).type = 0;
                        end
                    else
                        matches(imatch).type = 0;
                    end
            end
        elseif matches(imatch).sequence >= 17
            switch matches(imatch).type
                case 1
                    if check1(matches(imatch).check).column >= 4
                        if board(check1(matches(imatch).check).row,...
                                check1(matches(imatch).check).column-3) ~= 0 ||...
                                board(check1(matches(imatch).check).row,...
                                check1(matches(imatch).check).column-2) ~= 0
                            matches(imatch).type = 0;
                        end
                    else
                        matches(imatch).type = 0;
                    end
                case 2
                    if check2(matches(imatch).check).row >= 4
                        if board(check2(matches(imatch).check).row-2,...
                                check2(matches(imatch).check).column) ~= 0 ||...
                                board(check2(matches(imatch).check).row-3,...
                                check2(matches(imatch).check).column) ~= 0
                            matches(imatch).type = 0;
                        end
                    else
                        matches(imatch).type = 0;
                    end
                case 3
                    if check3(matches(imatch).check).row >= 4 &&...
                            check3(matches(imatch).check).column >= 4
                        if board(check3(matches(imatch).check).row-2,...
                                check3(matches(imatch).check).column-2) ~= 0 ||...
                                board(check3(matches(imatch).check).row-3,...
                                check3(matches(imatch).check).column-3) ~= 0
                            matches(imatch).type = 0;
                        end
                    else
                        matches(imatch).type = 0;
                    end
                case 4
                    if check4(matches(imatch).check).row >= 4 &&...
                            check4(matches(imatch).check).column <= 12
                        if board(check4(matches(imatch).check).row-2,...
                                check4(matches(imatch).check).column+2) ~= 0 ||...
                                board(check4(matches(imatch).check).row-3,...
                                check4(matches(imatch).check).column+3) ~= 0
                            matches(imatch).type = 0;
                        end
                    else
                        matches(imatch).type = 0;
                    end
            end
        end
    end
    forwardThreats =  matches([matches.type]==1);
    downwardThreats = matches([matches.type]==2);
    diagForwardThreats = matches([matches.type]==3);
    diagBackwardThreats = matches([matches.type]==4);
end
if ~isMatch
    forwardThreats =  [];
    downwardThreats = [];
    diagForwardThreats = [];
    diagBackwardThreats = [];
end

%% Gain squares and cost squares
gainSquareCounter = 0;
gainCostSquares = [];

%forward
if ~isempty(forwardThreats)
    for ithreat = 1:length(forwardThreats)
        gainSquareCounter = gainSquareCounter + 2;
        switch forwardThreats(ithreat).sequence
            case 1
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
            case 2
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
            case 3
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
            case 4
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
            case 5
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1];
            case 6
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
            case 7
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
            case 8
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
            case 9
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+4];
            case 10
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
            case 11
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
            case 12
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
            case 13
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
            case 14
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
            case 15
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
            case 16
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+3];
            case 17
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
            case 18
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
            case 19
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
            case 20
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-1;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column-3;...
                    check1(forwardThreats(ithreat).check).row,...
                    check1(forwardThreats(ithreat).check).column+2];
        end
    end
end

%down
if ~isempty(downwardThreats)
    for ithreat = 1:length(downwardThreats)
        gainSquareCounter = gainSquareCounter + 2;
        switch downwardThreats(ithreat).sequence
            case 1
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
            case 2
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
            case 3
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
            case 4
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
            case 5
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column];
            case 6
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
            case 7
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
            case 8
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
            case 9
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+4,...
                    check1(downwardThreats(ithreat).check).column];
            case 10
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
            case 11
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
            case 12
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
            case 13
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
            case 14
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
            case 15
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
            case 16
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row+1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+3,...
                    check1(downwardThreats(ithreat).check).column];
            case 17
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
            case 18
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
            case 19
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
            case 20
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(downwardThreats(ithreat).check).row-2,...
                    check1(downwardThreats(ithreat).check).column];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(downwardThreats(ithreat).check).row-1,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row-3,...
                    check1(downwardThreats(ithreat).check).column;...
                    check1(downwardThreats(ithreat).check).row+2,...
                    check1(downwardThreats(ithreat).check).column];
        end
    end
end

%diagonal forward
if ~isempty(diagForwardThreats)
    for ithreat = 1:length(diagForwardThreats)
        gainSquareCounter = gainSquareCounter + 2;
        switch diagForwardThreats(ithreat).sequence
            case 1
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
            case 2
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
            case 3
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
            case 4
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
            case 5
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1];
            case 6
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
            case 7
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3;...
                    check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1;...
                    check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
            case 8
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3;...
                    check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2;...
                    check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
            case 9
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2;...
                    check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1;...
                    check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row+4,...
                    check1(diagForwardThreats(ithreat).check).column+4];
            case 10
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
            case 11
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
            case 12
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
            case 13
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1;...
                    check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
            case 14
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2;...
                    check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
            case 15
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2;...
                    check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
            case 16
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row+1,...
                    check1(diagForwardThreats(ithreat).check).column+1;...
                    check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row+3,...
                    check1(diagForwardThreats(ithreat).check).column+3];
            case 17
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row-3,...
                    check1(diagForwardThreats(ithreat).check).column-3;...
                    check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row-3,...
                    check1(diagForwardThreats(ithreat).check).column-3;...
                    check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
            case 18
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row-3,...
                    check1(diagForwardThreats(ithreat).check).column-3;...
                    check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row-3,...
                    check1(diagForwardThreats(ithreat).check).column-3;...
                    check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
            case 19
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row-3,...
                    check1(diagForwardThreats(ithreat).check).column-3;...
                    check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row-3,...
                    check1(diagForwardThreats(ithreat).check).column-3;...
                    check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
            case 20
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2;...
                    check1(diagForwardThreats(ithreat).check).row-3,...
                    check1(diagForwardThreats(ithreat).check).column-3;...
                    check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagForwardThreats(ithreat).check).row-2,...
                    check1(diagForwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagForwardThreats(ithreat).check).row-1,...
                    check1(diagForwardThreats(ithreat).check).column-1;...
                    check1(diagForwardThreats(ithreat).check).row-3,...
                    check1(diagForwardThreats(ithreat).check).column-3;...
                    check1(diagForwardThreats(ithreat).check).row+2,...
                    check1(diagForwardThreats(ithreat).check).column+2];
        end
    end
end

%Diagonal backwards
if ~isempty(diagBackwardThreats)
    for ithreat = 1:length(diagBackwardThreats)
        gainSquareCounter = gainSquareCounter + 2;
        switch diagBackwardThreats(ithreat).sequence
            case 1
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
            case 2
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
            case 3
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
            case 4
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
            case 5
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1];
            case 6
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
            case 7
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3;...
                    check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1;...
                    check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
            case 8
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3;...
                    check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2;...
                    check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
            case 9
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2;...
                    check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1;...
                    check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row+4,...
                    check1(diagBackwardThreats(ithreat).check).column-4];
            case 10
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
            case 11
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
            case 12
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
            case 13
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1;...
                    check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
            case 14
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2;...
                    check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
            case 15
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2;...
                    check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
            case 16
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row+1,...
                    check1(diagBackwardThreats(ithreat).check).column-1;...
                    check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row+3,...
                    check1(diagBackwardThreats(ithreat).check).column-3];
            case 17
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row-3,...
                    check1(diagBackwardThreats(ithreat).check).column+3;...
                    check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row-3,...
                    check1(diagBackwardThreats(ithreat).check).column+3;...
                    check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
            case 18
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row-3,...
                    check1(diagBackwardThreats(ithreat).check).column+3;...
                    check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row-3,...
                    check1(diagBackwardThreats(ithreat).check).column+3;...
                    check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
            case 19
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row-3,...
                    check1(diagBackwardThreats(ithreat).check).column+3;...
                    check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row-3,...
                    check1(diagBackwardThreats(ithreat).check).column+3;...
                    check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
            case 20
                gainCostSquares(gainSquareCounter-1).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1];
                gainCostSquares(gainSquareCounter-1).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2;...
                    check1(diagBackwardThreats(ithreat).check).row-3,...
                    check1(diagBackwardThreats(ithreat).check).column+3;...
                    check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
                gainCostSquares(gainSquareCounter).gain =...
                    [check1(diagBackwardThreats(ithreat).check).row-2,...
                    check1(diagBackwardThreats(ithreat).check).column+2];
                gainCostSquares(gainSquareCounter).cost =...
                    [check1(diagBackwardThreats(ithreat).check).row-1,...
                    check1(diagBackwardThreats(ithreat).check).column+1;...
                    check1(diagBackwardThreats(ithreat).check).row-3,...
                    check1(diagBackwardThreats(ithreat).check).column+3;...
                    check1(diagBackwardThreats(ithreat).check).row+2,...
                    check1(diagBackwardThreats(ithreat).check).column-2];
        end
    end
end
if ~isMatch
    gainCostSquares = [];
end